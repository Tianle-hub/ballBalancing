#include <tum_ics_ur10_controller_tutorial/UR10Model.h>

namespace tum_ics_ur_robot_lli
{
  namespace ur10_model
  {
    UR10Model::UR10Model()
    {
    }

    UR10Model::~UR10Model()
    {
    }

    void UR10Model::initModel(const JointState &state_init, const int n)
    {
      H_0_.resize(n);
      J_0_.resize(n);
      ps_.l << 0.1273, -0.612, -0.5723, 0.163941, 0.1157, 0.0922;
      ps_.m << 7.1, 12.7, 4.27, 2, 2, 0.365;
      ps_.I0 << 0.03408, 0.00002, -0.00425, 0.03529, 0.00008, 0.02156;
      ps_.I1 << 0.02814, 0.00005, -0.01561, 0.77068, 0.00002, 0.76943;
      ps_.I2 << 0.01014, 0.00008, 0.00916, 0.30928, 0.00000, 0.30646;
      ps_.I3 << 0.00296, -0.00001, -0.00000, 0.00222, -0.00024, 0.00258;
      ps_.I4 << 0.00296, -0.00001, -0.00000, 0.00222, -0.00024, 0.00258;
      ps_.I5 << 0.00040, 0.00000,  -0.00000, 0.00041, 0.00000, 0.00034;
      ps_.tcm0 << 0.021, 0.000, 0.027;
      ps_.tcm1 << 0.38, 0.000, 0.158;
      ps_.tcm2 << 0.24, 0.000, 0.068;
      ps_.tcm3 << 0.000, 0.007, 0.018;
      ps_.tcm4 << 0.000, 0.007, 0.018;
      ps_.tcm5 << 0, 0, -0.026;
    }

    void UR10Model::updateJointState(const JointState &state_new)
    {
      state_ = state_new;
    }

    std::vector<Matrix4d> UR10Model::computeForwardKinematics()
    {
      UR10Model::computeFKJoint0();
      UR10Model::computeFKJoint1();
      UR10Model::computeFKJoint2();
      UR10Model::computeFKJoint3();
      UR10Model::computeFKJoint4();
      UR10Model::computeFKJoint5();

      return H_0_;
    }

    void UR10Model::computeJacobian()
    {

    }

    void UR10Model::computeDynamic()
    {

    }

    void UR10Model::computeInertialMatrix()
    {
      Matrix6d M = Matrix6d::Zero();
      M(0, 0) = I111 + I112*cos(q2 + q3 + q4)^2 + I122*cos(q2 + q3 + q4)^2 + m5*(d4*sin(q1) + a2*cos(q1)*cos(q2) + tcm53*cos(q5)*sin(q1) + tcm51*sin(q1)*sin(q5) + d5*sin(q2 + q3 + q4)*cos(q1) - tcm52*sin(q2 + q3 + q4)*cos(q1) + a3*cos(q1)*cos(q2)*cos(q3) - a3*cos(q1)*sin(q2)*sin(q3) + tcm51*cos(q2 + q3 + q4)*cos(q1)*cos(q5) - tcm53*cos(q2 + q3 + q4)*cos(q1)*sin(q5))^2 + m3*(tcm33*cos(q1) - a2*cos(q2)*sin(q1) - a3*cos(q2)*cos(q3)*sin(q1) - tcm31*cos(q2)*cos(q3)*sin(q1) + a3*sin(q1)*sin(q2)*sin(q3) + tcm32*cos(q2)*sin(q1)*sin(q3) + tcm32*cos(q3)*sin(q1)*sin(q2) + tcm31*sin(q1)*sin(q2)*sin(q3))^2 + I112*sin(q2 + q3 + q4)^2 + m6*(d4*sin(q1) + a2*cos(q1)*cos(q2) + d6*cos(q5)*sin(q1) + tcm63*cos(q5)*sin(q1) + d5*sin(q2 + q3 + q4)*cos(q1) + a3*cos(q1)*cos(q2)*cos(q3) - a3*cos(q1)*sin(q2)*sin(q3) + tcm61*cos(q6)*sin(q1)*sin(q5) - tcm62*sin(q1)*sin(q5)*sin(q6) - d6*cos(q2 + q3 + q4)*cos(q1)*sin(q5) - tcm62*sin(q2 + q3 + q4)*cos(q1)*cos(q6) - tcm63*cos(q2 + q3 + q4)*cos(q1)*sin(q5) - tcm61*sin(q2 + q3 + q4)*cos(q1)*sin(q6) + tcm61*cos(q2 + q3 + q4)*cos(q1)*cos(q5)*cos(q6) - tcm62*cos(q2 + q3 + q4)*cos(q1)*cos(q5)*sin(q6))^2 + m5*(d4*cos(q1) - a2*cos(q2)*sin(q1) + tcm53*cos(q1)*cos(q5) + tcm51*cos(q1)*sin(q5) - d5*sin(q2 + q3 + q4)*sin(q1) + tcm52*sin(q2 + q3 + q4)*sin(q1) - a3*cos(q2)*cos(q3)*sin(q1) + a3*sin(q1)*sin(q2)*sin(q3) - tcm51*cos(q2 + q3 + q4)*cos(q5)*sin(q1) + tcm53*cos(q2 + q3 + q4)*sin(q1)*sin(q5))^2 + m4*(d4*sin(q1) + tcm42*sin(q1) + a2*cos(q1)*cos(q2) + tcm41*cos(q2 + q3 + q4)*cos(q1) + tcm43*sin(q2 + q3 + q4)*cos(q1) + a3*cos(q1)*cos(q2)*cos(q3) - a3*cos(q1)*sin(q2)*sin(q3))^2 + m6*(d4*cos(q1) + d6*cos(q1)*cos(q5) - a2*cos(q2)*sin(q1) + tcm63*cos(q1)*cos(q5) - d5*sin(q2 + q3 + q4)*sin(q1) - a3*cos(q2)*cos(q3)*sin(q1) + tcm61*cos(q1)*cos(q6)*sin(q5) + a3*sin(q1)*sin(q2)*sin(q3) - tcm62*cos(q1)*sin(q5)*sin(q6) + d6*cos(q2 + q3 + q4)*sin(q1)*sin(q5) + tcm62*sin(q2 + q3 + q4)*cos(q6)*sin(q1) + tcm63*cos(q2 + q3 + q4)*sin(q1)*sin(q5) + tcm61*sin(q2 + q3 + q4)*sin(q1)*sin(q6) - tcm61*cos(q2 + q3 + q4)*cos(q5)*cos(q6)*sin(q1) + tcm62*cos(q2 + q3 + q4)*cos(q5)*sin(q1)*sin(q6))^2 + m4*(a2*cos(q2)*sin(q1) - tcm42*cos(q1) - d4*cos(q1) + tcm41*cos(q2 + q3 + q4)*sin(q1) + tcm43*sin(q2 + q3 + q4)*sin(q1) + a3*cos(q2)*cos(q3)*sin(q1) - a3*sin(q1)*sin(q2)*sin(q3))^2 + I113*cos(q2 + q3)^2 + m2*(tcm23*sin(q1) + a2*cos(q1)*cos(q2) + tcm21*cos(q1)*cos(q2) - tcm22*cos(q1)*sin(q2))^2 + I113*sin(q2 + q3)^2 + m3*(tcm33*sin(q1) + a2*cos(q1)*cos(q2) + a3*cos(q1)*cos(q2)*cos(q3) + tcm31*cos(q1)*cos(q2)*cos(q3) - a3*cos(q1)*sin(q2)*sin(q3) - tcm32*cos(q1)*cos(q2)*sin(q3) - tcm32*cos(q1)*cos(q3)*sin(q2) - tcm31*cos(q1)*sin(q2)*sin(q3))^2 + m2*(tcm23*cos(q1) - a2*cos(q2)*sin(q1) - tcm21*cos(q2)*sin(q1) + tcm22*sin(q1)*sin(q2))^2 + I112*cos(q2)^2 + m1*(tcm11*cos(q1) + tcm13*sin(q1))^2 + m1*(tcm13*cos(q1) - tcm11*sin(q1))^2 + I112*sin(q2)^2 + I123*(cos(q2 + q3 + q4)*sin(q6) + sin(q2 + q3 + q4)*cos(q5)*cos(q6))^2 + I123*(cos(q2 + q3 + q4)*cos(q6) - sin(q2 + q3 + q4)*cos(q5)*sin(q6))^2 + I122*sin(q2 + q3 + q4)^2*cos(q5)^2 + I122*sin(q2 + q3 + q4)^2*sin(q5)^2 + I123*sin(q2 + q3 + q4)^2*sin(q5)^2;
      M(0, 1) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (d6^2*m6*cos(q2 + q3 + q4 - 2*q5))/4 - (d6^2*m6*cos(q2 + q3 + q4 + 2*q5))/4 - (m5*tcm51^2*cos(q2 + q3 + q4 - 2*q5))/4 + (m5*tcm51^2*cos(q2 + q3 + q4 + 2*q5))/4 + (m5*tcm53^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m5*tcm53^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5))/8 + (m6*tcm63^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m6*tcm63^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 - q5))/2 - (a3*m5*tcm51*cos(q2 + q3 - q5))/2 + (a2*m6*tcm61*cos(q2 + q5 - q6))/4 - (a2*m6*tcm61*cos(q2 - q5 + q6))/4 - (a2*m6*tcm61*cos(q5 - q2 + q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 - q5))/2 - (a3*m6*tcm63*sin(q2 + q3 - q5))/2 + (a2*m6*tcm62*sin(q2 + q5 - q6))/4 + (a2*m6*tcm62*sin(q2 - q5 + q6))/4 + (a2*m6*tcm62*sin(q5 - q2 + q6))/4 + (a3*m6*tcm61*cos(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q6))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (a3*m6*tcm62*sin(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 - a3*d4*m4*sin(q2 + q3) - a3*d4*m5*sin(q2 + q3) - a3*d4*m6*sin(q2 + q3) - (a2*d6*m6*sin(q2 + q5))/2 + (a2*m5*tcm51*cos(q2 + q5))/2 - (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 - a3*m3*tcm33*sin(q2 + q3) - a3*m4*tcm42*sin(q2 + q3) - (a2*m5*tcm53*sin(q2 + q5))/2 - (a2*m6*tcm63*sin(q2 + q5))/2 - m3*tcm32*tcm33*cos(q2 + q3) + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - m3*tcm31*tcm33*sin(q2 + q3) - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - a2*d4*m4*sin(q2) - a2*d4*m5*sin(q2) - a2*d4*m6*sin(q2) + (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 - 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 + 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 - 2*q6))/8 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 + 2*q6))/8 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - a2*m2*tcm23*sin(q2) - a2*m3*tcm33*sin(q2) - a2*m4*tcm42*sin(q2) + (a3*m6*tcm61*cos(q2 + q3 + q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 + q6))/4 - m2*tcm22*tcm23*cos(q2) + (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q6))/2 + (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d6*m6*tcm63*cos(q2 + q3 + q4 - 2*q5))/2 - (d6*m6*tcm63*cos(q2 + q3 + q4 + 2*q5))/2 + (a3*m6*tcm62*sin(q2 + q3 + q5 - q6))/4 + (a3*m6*tcm62*sin(q2 + q3 - q5 + q6))/4 - m2*tcm21*tcm23*sin(q2) - (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*d6*m6*sin(q2 - q5))/2 - (a2*m5*tcm51*cos(q2 - q5))/2 + d4*d5*m5*cos(q2 + q3 + q4) + d4*d5*m6*cos(q2 + q3 + q4) + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 - 2*q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 + 2*q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*m5*tcm53*sin(q2 - q5))/2 - (a2*m6*tcm63*sin(q2 - q5))/2 - (a3*d6*m6*sin(q2 + q3 + q5))/2 + (a3*m5*tcm51*cos(q2 + q3 + q5))/2 + (a2*m6*tcm61*cos(q2 + q5 + q6))/4 + d4*m4*tcm43*cos(q2 + q3 + q4) - d4*m5*tcm52*cos(q2 + q3 + q4) - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 + q5))/2 - (a3*m6*tcm63*sin(q2 + q3 + q5))/2 - (a2*m6*tcm62*sin(q2 + q5 + q6))/4 - d4*m4*tcm41*sin(q2 + q3 + q4) + m4*tcm42*tcm43*cos(q2 + q3 + q4) - m4*tcm41*tcm42*sin(q2 + q3 + q4) - (a3*m6*tcm61*cos(q2 + q3 - q5 - q6))/4 - (a3*m6*tcm62*sin(q2 + q3 - q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 + q6))/4;
      M(0, 2) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (d6^2*m6*cos(q2 + q3 + q4 - 2*q5))/4 - (d6^2*m6*cos(q2 + q3 + q4 + 2*q5))/4 - (m5*tcm51^2*cos(q2 + q3 + q4 - 2*q5))/4 + (m5*tcm51^2*cos(q2 + q3 + q4 + 2*q5))/4 + (m5*tcm53^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m5*tcm53^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5))/8 + (m6*tcm63^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m6*tcm63^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 - q5))/2 - (a3*m5*tcm51*cos(q2 + q3 - q5))/2 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 - q5))/2 - (a3*m6*tcm63*sin(q2 + q3 - q5))/2 + (a3*m6*tcm61*cos(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q6))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (a3*m6*tcm62*sin(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 - a3*d4*m4*sin(q2 + q3) - a3*d4*m5*sin(q2 + q3) - a3*d4*m6*sin(q2 + q3) - (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 - a3*m3*tcm33*sin(q2 + q3) - a3*m4*tcm42*sin(q2 + q3) - m3*tcm32*tcm33*cos(q2 + q3) + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - m3*tcm31*tcm33*sin(q2 + q3) - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 - q6))/4 + (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 - 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 + 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 - 2*q6))/8 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 + 2*q6))/8 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 - q6))/4 + (a3*m6*tcm61*cos(q2 + q3 + q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 + q6))/4 + (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q6))/2 + (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d6*m6*tcm63*cos(q2 + q3 + q4 - 2*q5))/2 - (d6*m6*tcm63*cos(q2 + q3 + q4 + 2*q5))/2 + (a3*m6*tcm62*sin(q2 + q3 + q5 - q6))/4 + (a3*m6*tcm62*sin(q2 + q3 - q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + d4*d5*m5*cos(q2 + q3 + q4) + d4*d5*m6*cos(q2 + q3 + q4) + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 - 2*q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 + 2*q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 + q5))/2 + (a3*m5*tcm51*cos(q2 + q3 + q5))/2 + d4*m4*tcm43*cos(q2 + q3 + q4) - d4*m5*tcm52*cos(q2 + q3 + q4) - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 + q5))/2 - (a3*m6*tcm63*sin(q2 + q3 + q5))/2 - d4*m4*tcm41*sin(q2 + q3 + q4) + m4*tcm42*tcm43*cos(q2 + q3 + q4) - m4*tcm41*tcm42*sin(q2 + q3 + q4) - (a3*m6*tcm61*cos(q2 + q3 - q5 - q6))/4 - (a3*m6*tcm62*sin(q2 + q3 - q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 + q6))/4;
      M(0, 3) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (d6^2*m6*cos(q2 + q3 + q4 - 2*q5))/4 - (d6^2*m6*cos(q2 + q3 + q4 + 2*q5))/4 - (m5*tcm51^2*cos(q2 + q3 + q4 - 2*q5))/4 + (m5*tcm51^2*cos(q2 + q3 + q4 + 2*q5))/4 + (m5*tcm53^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m5*tcm53^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5))/8 + (m6*tcm63^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m6*tcm63^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 + q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q6))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 - (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 - q6))/4 + (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 - 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 + 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 - 2*q6))/8 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 + 2*q6))/8 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 - q6))/4 + (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q6))/2 + (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d6*m6*tcm63*cos(q2 + q3 + q4 - 2*q5))/2 - (d6*m6*tcm63*cos(q2 + q3 + q4 + 2*q5))/2 - (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + d4*d5*m5*cos(q2 + q3 + q4) + d4*d5*m6*cos(q2 + q3 + q4) + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 - 2*q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 + 2*q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 + d4*m4*tcm43*cos(q2 + q3 + q4) - d4*m5*tcm52*cos(q2 + q3 + q4) - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 - d4*m4*tcm41*sin(q2 + q3 + q4) + m4*tcm42*tcm43*cos(q2 + q3 + q4) - m4*tcm41*tcm42*sin(q2 + q3 + q4) + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 + q6))/4;
      M(0, 4) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - I123*cos(q2 + q3 + q4) - I122*cos(q2 + q3 + q4) - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q6))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q6))/4 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q6))/4 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q6))/4 - d6^2*m6*cos(q2 + q3 + q4) - m5*tcm51^2*cos(q2 + q3 + q4) - m5*tcm53^2*cos(q2 + q3 + q4) - (m6*tcm61^2*cos(q2 + q3 + q4))/2 - (m6*tcm62^2*cos(q2 + q3 + q4))/2 - m6*tcm63^2*cos(q2 + q3 + q4) + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 - q5))/2 - (a3*m5*tcm51*cos(q2 + q3 - q5))/2 - (a2*m6*tcm61*cos(q2 + q5 - q6))/4 - (a2*m6*tcm61*cos(q2 - q5 + q6))/4 - (a2*m6*tcm61*cos(q5 - q2 + q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 - q5))/2 - (a3*m6*tcm63*sin(q2 + q3 - q5))/2 - (a2*m6*tcm62*sin(q2 + q5 - q6))/4 + (a2*m6*tcm62*sin(q2 - q5 + q6))/4 + (a2*m6*tcm62*sin(q5 - q2 + q6))/4 - (a3*m6*tcm61*cos(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (a3*m6*tcm62*sin(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 + (a2*d6*m6*sin(q2 + q5))/2 - (a2*m5*tcm51*cos(q2 + q5))/2 + (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 + (a2*m5*tcm53*sin(q2 + q5))/2 + (a2*m6*tcm63*sin(q2 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 + q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 - (a3*m6*tcm62*sin(q2 + q3 + q5 - q6))/4 + (a3*m6*tcm62*sin(q2 + q3 - q5 + q6))/4 + (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*d6*m6*sin(q2 - q5))/2 - (a2*m5*tcm51*cos(q2 - q5))/2 + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q6))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q6))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*m5*tcm53*sin(q2 - q5))/2 - (a2*m6*tcm63*sin(q2 - q5))/2 + (a3*d6*m6*sin(q2 + q3 + q5))/2 - (a3*m5*tcm51*cos(q2 + q3 + q5))/2 - (a2*m6*tcm61*cos(q2 + q5 + q6))/4 - 2*d6*m6*tcm63*cos(q2 + q3 + q4) + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 + (a3*m5*tcm53*sin(q2 + q3 + q5))/2 + (a3*m6*tcm63*sin(q2 + q3 + q5))/2 + (a2*m6*tcm62*sin(q2 + q5 + q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 - q6))/4 - (a3*m6*tcm62*sin(q2 + q3 - q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4;
      M(0, 5) = I123*sin(q2)*sin(q3)*sin(q4)*sin(q5) - I123*cos(q2)*cos(q4)*sin(q3)*sin(q5) - I123*cos(q3)*cos(q4)*sin(q2)*sin(q5) - I123*cos(q2)*cos(q3)*sin(q4)*sin(q5) - m6*tcm61^2*cos(q2)*cos(q3)*sin(q4)*sin(q5) - m6*tcm61^2*cos(q2)*cos(q4)*sin(q3)*sin(q5) - m6*tcm61^2*cos(q3)*cos(q4)*sin(q2)*sin(q5) - m6*tcm62^2*cos(q2)*cos(q3)*sin(q4)*sin(q5) - m6*tcm62^2*cos(q2)*cos(q4)*sin(q3)*sin(q5) - m6*tcm62^2*cos(q3)*cos(q4)*sin(q2)*sin(q5) + a2*m6*tcm62*cos(q2)*cos(q6)*sin(q5) + m6*tcm61^2*sin(q2)*sin(q3)*sin(q4)*sin(q5) + m6*tcm62^2*sin(q2)*sin(q3)*sin(q4)*sin(q5) + a2*m6*tcm61*cos(q2)*sin(q5)*sin(q6) + a3*m6*tcm62*cos(q2)*cos(q3)*cos(q6)*sin(q5) - d4*m6*tcm61*cos(q2)*cos(q3)*cos(q6)*sin(q4) - d4*m6*tcm61*cos(q2)*cos(q4)*cos(q6)*sin(q3) - d4*m6*tcm61*cos(q3)*cos(q4)*cos(q6)*sin(q2) - d6*m6*tcm61*cos(q2)*cos(q3)*cos(q4)*sin(q6) - m6*tcm62*tcm63*cos(q2)*cos(q3)*cos(q4)*cos(q6) + a3*m6*tcm61*cos(q2)*cos(q3)*sin(q5)*sin(q6) + d4*m6*tcm62*cos(q2)*cos(q3)*sin(q4)*sin(q6) + d4*m6*tcm62*cos(q2)*cos(q4)*sin(q3)*sin(q6) + d4*m6*tcm62*cos(q3)*cos(q4)*sin(q2)*sin(q6) + d6*m6*tcm62*cos(q2)*cos(q6)*sin(q3)*sin(q4) + d6*m6*tcm62*cos(q3)*cos(q6)*sin(q2)*sin(q4) + d6*m6*tcm62*cos(q4)*cos(q6)*sin(q2)*sin(q3) - m6*tcm61*tcm63*cos(q2)*cos(q3)*cos(q4)*sin(q6) - a3*m6*tcm62*cos(q6)*sin(q2)*sin(q3)*sin(q5) + d4*m6*tcm61*cos(q6)*sin(q2)*sin(q3)*sin(q4) + d6*m6*tcm61*cos(q2)*sin(q3)*sin(q4)*sin(q6) + d6*m6*tcm61*cos(q3)*sin(q2)*sin(q4)*sin(q6) + d6*m6*tcm61*cos(q4)*sin(q2)*sin(q3)*sin(q6) + m6*tcm62*tcm63*cos(q2)*cos(q6)*sin(q3)*sin(q4) + m6*tcm62*tcm63*cos(q3)*cos(q6)*sin(q2)*sin(q4) + m6*tcm62*tcm63*cos(q4)*cos(q6)*sin(q2)*sin(q3) - a3*m6*tcm61*sin(q2)*sin(q3)*sin(q5)*sin(q6) - d4*m6*tcm62*sin(q2)*sin(q3)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q2)*sin(q3)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q3)*sin(q2)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q4)*sin(q2)*sin(q3)*sin(q6) - d6*m6*tcm62*cos(q2)*cos(q3)*cos(q4)*cos(q6) - d5*m6*tcm62*cos(q6)*sin(q2)*sin(q3)*sin(q4)*sin(q5) - d6*m6*tcm62*cos(q5)*sin(q2)*sin(q3)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q2)*sin(q3)*sin(q4) - d5*m6*tcm61*sin(q2)*sin(q3)*sin(q4)*sin(q5)*sin(q6) - m6*tcm62*tcm63*cos(q5)*sin(q2)*sin(q3)*sin(q4)*sin(q6) - d4*m6*tcm62*cos(q2)*cos(q3)*cos(q4)*cos(q5)*cos(q6) - d4*m6*tcm61*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q2)*cos(q3)*cos(q5)*cos(q6)*sin(q4) - d6*m6*tcm61*cos(q2)*cos(q4)*cos(q5)*cos(q6)*sin(q3) - d6*m6*tcm61*cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(q2) + d4*m6*tcm62*cos(q2)*cos(q5)*cos(q6)*sin(q3)*sin(q4) + d4*m6*tcm62*cos(q3)*cos(q5)*cos(q6)*sin(q2)*sin(q4) + d4*m6*tcm62*cos(q4)*cos(q5)*cos(q6)*sin(q2)*sin(q3) + d5*m6*tcm62*cos(q2)*cos(q3)*cos(q6)*sin(q4)*sin(q5) + d5*m6*tcm62*cos(q2)*cos(q4)*cos(q6)*sin(q3)*sin(q5) + d5*m6*tcm62*cos(q3)*cos(q4)*cos(q6)*sin(q2)*sin(q5) + d6*m6*tcm62*cos(q2)*cos(q3)*cos(q5)*sin(q4)*sin(q6) + d6*m6*tcm62*cos(q2)*cos(q4)*cos(q5)*sin(q3)*sin(q6) + d6*m6*tcm62*cos(q3)*cos(q4)*cos(q5)*sin(q2)*sin(q6) - m6*tcm61*tcm63*cos(q2)*cos(q3)*cos(q5)*cos(q6)*sin(q4) - m6*tcm61*tcm63*cos(q2)*cos(q4)*cos(q5)*cos(q6)*sin(q3) - m6*tcm61*tcm63*cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(q2) + d4*m6*tcm61*cos(q2)*cos(q5)*sin(q3)*sin(q4)*sin(q6) + d4*m6*tcm61*cos(q3)*cos(q5)*sin(q2)*sin(q4)*sin(q6) + d4*m6*tcm61*cos(q4)*cos(q5)*sin(q2)*sin(q3)*sin(q6) + d5*m6*tcm61*cos(q2)*cos(q3)*sin(q4)*sin(q5)*sin(q6) + d5*m6*tcm61*cos(q2)*cos(q4)*sin(q3)*sin(q5)*sin(q6) + d5*m6*tcm61*cos(q3)*cos(q4)*sin(q2)*sin(q5)*sin(q6) + d6*m6*tcm61*cos(q5)*cos(q6)*sin(q2)*sin(q3)*sin(q4) + m6*tcm62*tcm63*cos(q2)*cos(q3)*cos(q5)*sin(q4)*sin(q6) + m6*tcm62*tcm63*cos(q2)*cos(q4)*cos(q5)*sin(q3)*sin(q6) + m6*tcm62*tcm63*cos(q3)*cos(q4)*cos(q5)*sin(q2)*sin(q6);
      M(1, 0) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (d6^2*m6*cos(q2 + q3 + q4 - 2*q5))/4 - (d6^2*m6*cos(q2 + q3 + q4 + 2*q5))/4 - (m5*tcm51^2*cos(q2 + q3 + q4 - 2*q5))/4 + (m5*tcm51^2*cos(q2 + q3 + q4 + 2*q5))/4 + (m5*tcm53^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m5*tcm53^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5))/8 + (m6*tcm63^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m6*tcm63^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 - q5))/2 - (a3*m5*tcm51*cos(q2 + q3 - q5))/2 + (a2*m6*tcm61*cos(q2 + q5 - q6))/4 - (a2*m6*tcm61*cos(q2 - q5 + q6))/4 - (a2*m6*tcm61*cos(q5 - q2 + q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 - q5))/2 - (a3*m6*tcm63*sin(q2 + q3 - q5))/2 + (a2*m6*tcm62*sin(q2 + q5 - q6))/4 + (a2*m6*tcm62*sin(q2 - q5 + q6))/4 + (a2*m6*tcm62*sin(q5 - q2 + q6))/4 + (a3*m6*tcm61*cos(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q6))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (a3*m6*tcm62*sin(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 - a3*d4*m4*sin(q2 + q3) - a3*d4*m5*sin(q2 + q3) - a3*d4*m6*sin(q2 + q3) - (a2*d6*m6*sin(q2 + q5))/2 + (a2*m5*tcm51*cos(q2 + q5))/2 - (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 - a3*m3*tcm33*sin(q2 + q3) - a3*m4*tcm42*sin(q2 + q3) - (a2*m5*tcm53*sin(q2 + q5))/2 - (a2*m6*tcm63*sin(q2 + q5))/2 - m3*tcm32*tcm33*cos(q2 + q3) + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - m3*tcm31*tcm33*sin(q2 + q3) - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - a2*d4*m4*sin(q2) - a2*d4*m5*sin(q2) - a2*d4*m6*sin(q2) + (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 - 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 + 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 - 2*q6))/8 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 + 2*q6))/8 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - a2*m2*tcm23*sin(q2) - a2*m3*tcm33*sin(q2) - a2*m4*tcm42*sin(q2) + (a3*m6*tcm61*cos(q2 + q3 + q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 + q6))/4 - m2*tcm22*tcm23*cos(q2) + (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q6))/2 + (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d6*m6*tcm63*cos(q2 + q3 + q4 - 2*q5))/2 - (d6*m6*tcm63*cos(q2 + q3 + q4 + 2*q5))/2 + (a3*m6*tcm62*sin(q2 + q3 + q5 - q6))/4 + (a3*m6*tcm62*sin(q2 + q3 - q5 + q6))/4 - m2*tcm21*tcm23*sin(q2) - (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*d6*m6*sin(q2 - q5))/2 - (a2*m5*tcm51*cos(q2 - q5))/2 + d4*d5*m5*cos(q2 + q3 + q4) + d4*d5*m6*cos(q2 + q3 + q4) + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 - 2*q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 + 2*q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*m5*tcm53*sin(q2 - q5))/2 - (a2*m6*tcm63*sin(q2 - q5))/2 - (a3*d6*m6*sin(q2 + q3 + q5))/2 + (a3*m5*tcm51*cos(q2 + q3 + q5))/2 + (a2*m6*tcm61*cos(q2 + q5 + q6))/4 + d4*m4*tcm43*cos(q2 + q3 + q4) - d4*m5*tcm52*cos(q2 + q3 + q4) - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 + q5))/2 - (a3*m6*tcm63*sin(q2 + q3 + q5))/2 - (a2*m6*tcm62*sin(q2 + q5 + q6))/4 - d4*m4*tcm41*sin(q2 + q3 + q4) + m4*tcm42*tcm43*cos(q2 + q3 + q4) - m4*tcm41*tcm42*sin(q2 + q3 + q4) - (a3*m6*tcm61*cos(q2 + q3 - q5 - q6))/4 - (a3*m6*tcm62*sin(q2 + q3 - q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 + q6))/4;
      M(1, 1) = 2*I112 + I113 + I122 + I123 + a2^2*m2 + a2^2*m3 + a2^2*m4 + a3^2*m3 + a2^2*m5 + a3^2*m4 + a2^2*m6 + a3^2*m5 + a3^2*m6 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m2*tcm21^2 + m2*tcm22^2 + m3*tcm31^2 + m3*tcm32^2 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 + 2*a2*m2*tcm21 + 2*a3*m3*tcm31 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + 2*a2*a3*m3*cos(q3) + 2*a2*a3*m4*cos(q3) + 2*a2*a3*m5*cos(q3) + 2*a2*a3*m6*cos(q3) + 2*a3*d5*m5*sin(q4) + 2*a3*d5*m6*sin(q4) + 2*a2*m3*tcm31*cos(q3) + 2*a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) - 2*a2*m3*tcm32*sin(q3) + 2*a3*m4*tcm43*sin(q4) - 2*a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) + 2*a2*d5*m5*cos(q3)*sin(q4) + 2*a2*d5*m5*cos(q4)*sin(q3) + 2*a2*d5*m6*cos(q3)*sin(q4) + 2*a2*d5*m6*cos(q4)*sin(q3) - 2*a3*d6*m6*cos(q4)*sin(q5) + 2*a2*m4*tcm41*cos(q3)*cos(q4) + 2*a3*m5*tcm51*cos(q4)*cos(q5) + 2*a2*m4*tcm43*cos(q3)*sin(q4) + 2*a2*m4*tcm43*cos(q4)*sin(q3) - 2*a2*m5*tcm52*cos(q3)*sin(q4) - 2*a2*m5*tcm52*cos(q4)*sin(q3) - 2*a3*m5*tcm53*cos(q4)*sin(q5) - 2*a3*m6*tcm62*cos(q6)*sin(q4) - 2*a3*m6*tcm63*cos(q4)*sin(q5) - 2*a2*m4*tcm41*sin(q3)*sin(q4) - 2*a3*m6*tcm61*sin(q4)*sin(q6) - 2*a2*d6*m6*cos(q3)*cos(q4)*sin(q5) + 2*a2*m5*tcm51*cos(q3)*cos(q4)*cos(q5) + 2*a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - 2*a2*m5*tcm53*cos(q3)*cos(q4)*sin(q5) - 2*a2*m6*tcm62*cos(q3)*cos(q6)*sin(q4) - 2*a2*m6*tcm62*cos(q4)*cos(q6)*sin(q3) - 2*a2*m6*tcm63*cos(q3)*cos(q4)*sin(q5) - 2*a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + 2*a2*d6*m6*sin(q3)*sin(q4)*sin(q5) - 2*a2*m5*tcm51*cos(q5)*sin(q3)*sin(q4) - 2*a2*m6*tcm61*cos(q3)*sin(q4)*sin(q6) - 2*a2*m6*tcm61*cos(q4)*sin(q3)*sin(q6) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + 2*a2*m5*tcm53*sin(q3)*sin(q4)*sin(q5) + 2*a2*m6*tcm63*sin(q3)*sin(q4)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6) - 2*a2*m6*tcm62*cos(q3)*cos(q4)*cos(q5)*sin(q6) - 2*a2*m6*tcm61*cos(q5)*cos(q6)*sin(q3)*sin(q4) + 2*a2*m6*tcm62*cos(q5)*sin(q3)*sin(q4)*sin(q6) + 2*a2*m6*tcm61*cos(q3)*cos(q4)*cos(q5)*cos(q6);
      M(1, 2) = I112 + I113 + I122 + I123 + a3^2*m3 + a3^2*m4 + a3^2*m5 + a3^2*m6 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m3*tcm31^2 + m3*tcm32^2 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 + 2*a3*m3*tcm31 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + a2*a3*m3*cos(q3) + a2*a3*m4*cos(q3) + a2*a3*m5*cos(q3) + a2*a3*m6*cos(q3) + 2*a3*d5*m5*sin(q4) + 2*a3*d5*m6*sin(q4) + a2*m3*tcm31*cos(q3) + 2*a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) - a2*m3*tcm32*sin(q3) + 2*a3*m4*tcm43*sin(q4) - 2*a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) + a2*d5*m5*cos(q3)*sin(q4) + a2*d5*m5*cos(q4)*sin(q3) + a2*d5*m6*cos(q3)*sin(q4) + a2*d5*m6*cos(q4)*sin(q3) - 2*a3*d6*m6*cos(q4)*sin(q5) + a2*m4*tcm41*cos(q3)*cos(q4) + 2*a3*m5*tcm51*cos(q4)*cos(q5) + a2*m4*tcm43*cos(q3)*sin(q4) + a2*m4*tcm43*cos(q4)*sin(q3) - a2*m5*tcm52*cos(q3)*sin(q4) - a2*m5*tcm52*cos(q4)*sin(q3) - 2*a3*m5*tcm53*cos(q4)*sin(q5) - 2*a3*m6*tcm62*cos(q6)*sin(q4) - 2*a3*m6*tcm63*cos(q4)*sin(q5) - a2*m4*tcm41*sin(q3)*sin(q4) - 2*a3*m6*tcm61*sin(q4)*sin(q6) - a2*d6*m6*cos(q3)*cos(q4)*sin(q5) + a2*m5*tcm51*cos(q3)*cos(q4)*cos(q5) + 2*a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - a2*m5*tcm53*cos(q3)*cos(q4)*sin(q5) - a2*m6*tcm62*cos(q3)*cos(q6)*sin(q4) - a2*m6*tcm62*cos(q4)*cos(q6)*sin(q3) - a2*m6*tcm63*cos(q3)*cos(q4)*sin(q5) - 2*a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + a2*d6*m6*sin(q3)*sin(q4)*sin(q5) - a2*m5*tcm51*cos(q5)*sin(q3)*sin(q4) - a2*m6*tcm61*cos(q3)*sin(q4)*sin(q6) - a2*m6*tcm61*cos(q4)*sin(q3)*sin(q6) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + a2*m5*tcm53*sin(q3)*sin(q4)*sin(q5) + a2*m6*tcm63*sin(q3)*sin(q4)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6) - a2*m6*tcm62*cos(q3)*cos(q4)*cos(q5)*sin(q6) - a2*m6*tcm61*cos(q5)*cos(q6)*sin(q3)*sin(q4) + a2*m6*tcm62*cos(q5)*sin(q3)*sin(q4)*sin(q6) + a2*m6*tcm61*cos(q3)*cos(q4)*cos(q5)*cos(q6);
      M(1, 3) = I112 + I122 + I123 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + a3*d5*m5*sin(q4) + a3*d5*m6*sin(q4) + a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) + a3*m4*tcm43*sin(q4) - a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) + a2*d5*m5*cos(q3)*sin(q4) + a2*d5*m5*cos(q4)*sin(q3) + a2*d5*m6*cos(q3)*sin(q4) + a2*d5*m6*cos(q4)*sin(q3) - a3*d6*m6*cos(q4)*sin(q5) + a2*m4*tcm41*cos(q3)*cos(q4) + a3*m5*tcm51*cos(q4)*cos(q5) + a2*m4*tcm43*cos(q3)*sin(q4) + a2*m4*tcm43*cos(q4)*sin(q3) - a2*m5*tcm52*cos(q3)*sin(q4) - a2*m5*tcm52*cos(q4)*sin(q3) - a3*m5*tcm53*cos(q4)*sin(q5) - a3*m6*tcm62*cos(q6)*sin(q4) - a3*m6*tcm63*cos(q4)*sin(q5) - a2*m4*tcm41*sin(q3)*sin(q4) - a3*m6*tcm61*sin(q4)*sin(q6) - a2*d6*m6*cos(q3)*cos(q4)*sin(q5) + a2*m5*tcm51*cos(q3)*cos(q4)*cos(q5) + a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - a2*m5*tcm53*cos(q3)*cos(q4)*sin(q5) - a2*m6*tcm62*cos(q3)*cos(q6)*sin(q4) - a2*m6*tcm62*cos(q4)*cos(q6)*sin(q3) - a2*m6*tcm63*cos(q3)*cos(q4)*sin(q5) - a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + a2*d6*m6*sin(q3)*sin(q4)*sin(q5) - a2*m5*tcm51*cos(q5)*sin(q3)*sin(q4) - a2*m6*tcm61*cos(q3)*sin(q4)*sin(q6) - a2*m6*tcm61*cos(q4)*sin(q3)*sin(q6) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + a2*m5*tcm53*sin(q3)*sin(q4)*sin(q5) + a2*m6*tcm63*sin(q3)*sin(q4)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6) - a2*m6*tcm62*cos(q3)*cos(q4)*cos(q5)*sin(q6) - a2*m6*tcm61*cos(q5)*cos(q6)*sin(q3)*sin(q4) + a2*m6*tcm62*cos(q5)*sin(q3)*sin(q4)*sin(q6) + a2*m6*tcm61*cos(q3)*cos(q4)*cos(q5)*cos(q6);
      M(1, 4) = m5*tcm52*tcm53*cos(q5) - d5*m5*tcm53*cos(q5) - d5*m6*tcm63*cos(q5) - d5*m5*tcm51*sin(q5) - d5*d6*m6*cos(q5) + m5*tcm51*tcm52*sin(q5) - m6*tcm61*tcm62*sin(q5) + m6*tcm61^2*cos(q6)*sin(q5)*sin(q6) - m6*tcm62^2*cos(q6)*sin(q5)*sin(q6) - a3*d6*m6*cos(q5)*sin(q4) + d6*m6*tcm62*cos(q5)*cos(q6) - a3*m5*tcm53*cos(q5)*sin(q4) - a3*m6*tcm63*cos(q5)*sin(q4) - d5*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm61*cos(q5)*sin(q6) + m6*tcm62*tcm63*cos(q5)*cos(q6) - a3*m5*tcm51*sin(q4)*sin(q5) + d5*m6*tcm62*sin(q5)*sin(q6) + m6*tcm61*tcm63*cos(q5)*sin(q6) + 2*m6*tcm61*tcm62*cos(q6)^2*sin(q5) - a2*d6*m6*cos(q3)*cos(q5)*sin(q4) - a2*d6*m6*cos(q4)*cos(q5)*sin(q3) - a2*m5*tcm53*cos(q3)*cos(q5)*sin(q4) - a2*m5*tcm53*cos(q4)*cos(q5)*sin(q3) - a2*m6*tcm63*cos(q3)*cos(q5)*sin(q4) - a2*m6*tcm63*cos(q4)*cos(q5)*sin(q3) - a2*m5*tcm51*cos(q3)*sin(q4)*sin(q5) - a2*m5*tcm51*cos(q4)*sin(q3)*sin(q5) - a3*m6*tcm61*cos(q6)*sin(q4)*sin(q5) + a3*m6*tcm62*sin(q4)*sin(q5)*sin(q6) - a2*m6*tcm61*cos(q3)*cos(q6)*sin(q4)*sin(q5) - a2*m6*tcm61*cos(q4)*cos(q6)*sin(q3)*sin(q5) + a2*m6*tcm62*cos(q3)*sin(q4)*sin(q5)*sin(q6) + a2*m6*tcm62*cos(q4)*sin(q3)*sin(q5)*sin(q6);
      M(1, 5) = I123*cos(q5) + m6*tcm61^2*cos(q5) + m6*tcm62^2*cos(q5) + a3*m6*tcm61*cos(q4)*cos(q6) - d5*m6*tcm62*cos(q5)*cos(q6) - a3*m6*tcm62*cos(q4)*sin(q6) - d5*m6*tcm61*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm62*sin(q5)*sin(q6) - m6*tcm61*tcm63*cos(q6)*sin(q5) + m6*tcm62*tcm63*sin(q5)*sin(q6) + a2*m6*tcm61*cos(q3)*cos(q4)*cos(q6) - a2*m6*tcm62*cos(q3)*cos(q4)*sin(q6) - a3*m6*tcm62*cos(q5)*cos(q6)*sin(q4) - a2*m6*tcm61*cos(q6)*sin(q3)*sin(q4) - a3*m6*tcm61*cos(q5)*sin(q4)*sin(q6) + a2*m6*tcm62*sin(q3)*sin(q4)*sin(q6) - a2*m6*tcm62*cos(q3)*cos(q5)*cos(q6)*sin(q4) - a2*m6*tcm62*cos(q4)*cos(q5)*cos(q6)*sin(q3) - a2*m6*tcm61*cos(q3)*cos(q5)*sin(q4)*sin(q6) - a2*m6*tcm61*cos(q4)*cos(q5)*sin(q3)*sin(q6);
      M(2, 0) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (d6^2*m6*cos(q2 + q3 + q4 - 2*q5))/4 - (d6^2*m6*cos(q2 + q3 + q4 + 2*q5))/4 - (m5*tcm51^2*cos(q2 + q3 + q4 - 2*q5))/4 + (m5*tcm51^2*cos(q2 + q3 + q4 + 2*q5))/4 + (m5*tcm53^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m5*tcm53^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5))/8 + (m6*tcm63^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m6*tcm63^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 - q5))/2 - (a3*m5*tcm51*cos(q2 + q3 - q5))/2 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 - q5))/2 - (a3*m6*tcm63*sin(q2 + q3 - q5))/2 + (a3*m6*tcm61*cos(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q6))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (a3*m6*tcm62*sin(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 - a3*d4*m4*sin(q2 + q3) - a3*d4*m5*sin(q2 + q3) - a3*d4*m6*sin(q2 + q3) - (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 - a3*m3*tcm33*sin(q2 + q3) - a3*m4*tcm42*sin(q2 + q3) - m3*tcm32*tcm33*cos(q2 + q3) + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - m3*tcm31*tcm33*sin(q2 + q3) - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 - q6))/4 + (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 - 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 + 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 - 2*q6))/8 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 + 2*q6))/8 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 - q6))/4 + (a3*m6*tcm61*cos(q2 + q3 + q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 + q6))/4 + (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q6))/2 + (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d6*m6*tcm63*cos(q2 + q3 + q4 - 2*q5))/2 - (d6*m6*tcm63*cos(q2 + q3 + q4 + 2*q5))/2 + (a3*m6*tcm62*sin(q2 + q3 + q5 - q6))/4 + (a3*m6*tcm62*sin(q2 + q3 - q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + d4*d5*m5*cos(q2 + q3 + q4) + d4*d5*m6*cos(q2 + q3 + q4) + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 - 2*q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 + 2*q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 + q5))/2 + (a3*m5*tcm51*cos(q2 + q3 + q5))/2 + d4*m4*tcm43*cos(q2 + q3 + q4) - d4*m5*tcm52*cos(q2 + q3 + q4) - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 + q5))/2 - (a3*m6*tcm63*sin(q2 + q3 + q5))/2 - d4*m4*tcm41*sin(q2 + q3 + q4) + m4*tcm42*tcm43*cos(q2 + q3 + q4) - m4*tcm41*tcm42*sin(q2 + q3 + q4) - (a3*m6*tcm61*cos(q2 + q3 - q5 - q6))/4 - (a3*m6*tcm62*sin(q2 + q3 - q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 + q6))/4;
      M(2, 1) = I112 + I113 + I122 + I123 + a3^2*m3 + a3^2*m4 + a3^2*m5 + a3^2*m6 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m3*tcm31^2 + m3*tcm32^2 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 + 2*a3*m3*tcm31 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + a2*a3*m3*cos(q3) + a2*a3*m4*cos(q3) + a2*a3*m5*cos(q3) + a2*a3*m6*cos(q3) + 2*a3*d5*m5*sin(q4) + 2*a3*d5*m6*sin(q4) + a2*m3*tcm31*cos(q3) + 2*a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) - a2*m3*tcm32*sin(q3) + 2*a3*m4*tcm43*sin(q4) - 2*a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) + a2*d5*m5*cos(q3)*sin(q4) + a2*d5*m5*cos(q4)*sin(q3) + a2*d5*m6*cos(q3)*sin(q4) + a2*d5*m6*cos(q4)*sin(q3) - 2*a3*d6*m6*cos(q4)*sin(q5) + a2*m4*tcm41*cos(q3)*cos(q4) + 2*a3*m5*tcm51*cos(q4)*cos(q5) + a2*m4*tcm43*cos(q3)*sin(q4) + a2*m4*tcm43*cos(q4)*sin(q3) - a2*m5*tcm52*cos(q3)*sin(q4) - a2*m5*tcm52*cos(q4)*sin(q3) - 2*a3*m5*tcm53*cos(q4)*sin(q5) - 2*a3*m6*tcm62*cos(q6)*sin(q4) - 2*a3*m6*tcm63*cos(q4)*sin(q5) - a2*m4*tcm41*sin(q3)*sin(q4) - 2*a3*m6*tcm61*sin(q4)*sin(q6) - a2*d6*m6*cos(q3)*cos(q4)*sin(q5) + a2*m5*tcm51*cos(q3)*cos(q4)*cos(q5) + 2*a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - a2*m5*tcm53*cos(q3)*cos(q4)*sin(q5) - a2*m6*tcm62*cos(q3)*cos(q6)*sin(q4) - a2*m6*tcm62*cos(q4)*cos(q6)*sin(q3) - a2*m6*tcm63*cos(q3)*cos(q4)*sin(q5) - 2*a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + a2*d6*m6*sin(q3)*sin(q4)*sin(q5) - a2*m5*tcm51*cos(q5)*sin(q3)*sin(q4) - a2*m6*tcm61*cos(q3)*sin(q4)*sin(q6) - a2*m6*tcm61*cos(q4)*sin(q3)*sin(q6) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + a2*m5*tcm53*sin(q3)*sin(q4)*sin(q5) + a2*m6*tcm63*sin(q3)*sin(q4)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6) - a2*m6*tcm62*cos(q3)*cos(q4)*cos(q5)*sin(q6) - a2*m6*tcm61*cos(q5)*cos(q6)*sin(q3)*sin(q4) + a2*m6*tcm62*cos(q5)*sin(q3)*sin(q4)*sin(q6) + a2*m6*tcm61*cos(q3)*cos(q4)*cos(q5)*cos(q6);
      M(2, 2) = I112 + I113 + I122 + I123 + a3^2*m3 + a3^2*m4 + a3^2*m5 + a3^2*m6 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m3*tcm31^2 + m3*tcm32^2 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 + 2*a3*m3*tcm31 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + 2*a3*d5*m5*sin(q4) + 2*a3*d5*m6*sin(q4) + 2*a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) + 2*a3*m4*tcm43*sin(q4) - 2*a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) - 2*a3*d6*m6*cos(q4)*sin(q5) + 2*a3*m5*tcm51*cos(q4)*cos(q5) - 2*a3*m5*tcm53*cos(q4)*sin(q5) - 2*a3*m6*tcm62*cos(q6)*sin(q4) - 2*a3*m6*tcm63*cos(q4)*sin(q5) - 2*a3*m6*tcm61*sin(q4)*sin(q6) + 2*a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - 2*a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6);
      M(2, 3) = I112 + I122 + I123 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + a3*d5*m5*sin(q4) + a3*d5*m6*sin(q4) + a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) + a3*m4*tcm43*sin(q4) - a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) - a3*d6*m6*cos(q4)*sin(q5) + a3*m5*tcm51*cos(q4)*cos(q5) - a3*m5*tcm53*cos(q4)*sin(q5) - a3*m6*tcm62*cos(q6)*sin(q4) - a3*m6*tcm63*cos(q4)*sin(q5) - a3*m6*tcm61*sin(q4)*sin(q6) + a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6);
      M(2, 4) = m5*tcm52*tcm53*cos(q5) - d5*m5*tcm53*cos(q5) - d5*m6*tcm63*cos(q5) - d5*m5*tcm51*sin(q5) - d5*d6*m6*cos(q5) + m5*tcm51*tcm52*sin(q5) - m6*tcm61*tcm62*sin(q5) + m6*tcm61^2*cos(q6)*sin(q5)*sin(q6) - m6*tcm62^2*cos(q6)*sin(q5)*sin(q6) - a3*d6*m6*cos(q5)*sin(q4) + d6*m6*tcm62*cos(q5)*cos(q6) - a3*m5*tcm53*cos(q5)*sin(q4) - a3*m6*tcm63*cos(q5)*sin(q4) - d5*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm61*cos(q5)*sin(q6) + m6*tcm62*tcm63*cos(q5)*cos(q6) - a3*m5*tcm51*sin(q4)*sin(q5) + d5*m6*tcm62*sin(q5)*sin(q6) + m6*tcm61*tcm63*cos(q5)*sin(q6) + 2*m6*tcm61*tcm62*cos(q6)^2*sin(q5) - a3*m6*tcm61*cos(q6)*sin(q4)*sin(q5) + a3*m6*tcm62*sin(q4)*sin(q5)*sin(q6);
      M(2, 5) = I123*cos(q5) + m6*tcm61^2*cos(q5) + m6*tcm62^2*cos(q5) + a3*m6*tcm61*cos(q4)*cos(q6) - d5*m6*tcm62*cos(q5)*cos(q6) - a3*m6*tcm62*cos(q4)*sin(q6) - d5*m6*tcm61*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm62*sin(q5)*sin(q6) - m6*tcm61*tcm63*cos(q6)*sin(q5) + m6*tcm62*tcm63*sin(q5)*sin(q6) - a3*m6*tcm62*cos(q5)*cos(q6)*sin(q4) - a3*m6*tcm61*cos(q5)*sin(q4)*sin(q6);
      M(3, 0) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (d6^2*m6*cos(q2 + q3 + q4 - 2*q5))/4 - (d6^2*m6*cos(q2 + q3 + q4 + 2*q5))/4 - (m5*tcm51^2*cos(q2 + q3 + q4 - 2*q5))/4 + (m5*tcm51^2*cos(q2 + q3 + q4 + 2*q5))/4 + (m5*tcm53^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m5*tcm53^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q5))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q5))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q5))/8 + (m6*tcm63^2*cos(q2 + q3 + q4 - 2*q5))/4 - (m6*tcm63^2*cos(q2 + q3 + q4 + 2*q5))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 + q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 + q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q6))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 - (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 - q6))/4 - (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + 2*q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 - 2*q5 - q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + 2*q5 - q6))/4 + (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 - 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q5 + 2*q6))/8 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 - 2*q6))/8 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q5 + 2*q6))/8 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - 2*q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + 2*q5 - q6))/4 + (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q6))/2 + (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d6*m6*tcm63*cos(q2 + q3 + q4 - 2*q5))/2 - (d6*m6*tcm63*cos(q2 + q3 + q4 + 2*q5))/2 - (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q6))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + d4*d5*m5*cos(q2 + q3 + q4) + d4*d5*m6*cos(q2 + q3 + q4) + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 - 2*q5))/2 - (m5*tcm51*tcm53*sin(q2 + q3 + q4 + 2*q5))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 + d4*m4*tcm43*cos(q2 + q3 + q4) - d4*m5*tcm52*cos(q2 + q3 + q4) - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 - d4*m4*tcm41*sin(q2 + q3 + q4) + m4*tcm42*tcm43*cos(q2 + q3 + q4) - m4*tcm41*tcm42*sin(q2 + q3 + q4) + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - 2*q5 + q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 + 2*q5 + q6))/4;
      M(3, 1) = I112 + I122 + I123 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + a3*d5*m5*sin(q4) + a3*d5*m6*sin(q4) + a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) + a3*m4*tcm43*sin(q4) - a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) + a2*d5*m5*cos(q3)*sin(q4) + a2*d5*m5*cos(q4)*sin(q3) + a2*d5*m6*cos(q3)*sin(q4) + a2*d5*m6*cos(q4)*sin(q3) - a3*d6*m6*cos(q4)*sin(q5) + a2*m4*tcm41*cos(q3)*cos(q4) + a3*m5*tcm51*cos(q4)*cos(q5) + a2*m4*tcm43*cos(q3)*sin(q4) + a2*m4*tcm43*cos(q4)*sin(q3) - a2*m5*tcm52*cos(q3)*sin(q4) - a2*m5*tcm52*cos(q4)*sin(q3) - a3*m5*tcm53*cos(q4)*sin(q5) - a3*m6*tcm62*cos(q6)*sin(q4) - a3*m6*tcm63*cos(q4)*sin(q5) - a2*m4*tcm41*sin(q3)*sin(q4) - a3*m6*tcm61*sin(q4)*sin(q6) - a2*d6*m6*cos(q3)*cos(q4)*sin(q5) + a2*m5*tcm51*cos(q3)*cos(q4)*cos(q5) + a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - a2*m5*tcm53*cos(q3)*cos(q4)*sin(q5) - a2*m6*tcm62*cos(q3)*cos(q6)*sin(q4) - a2*m6*tcm62*cos(q4)*cos(q6)*sin(q3) - a2*m6*tcm63*cos(q3)*cos(q4)*sin(q5) - a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + a2*d6*m6*sin(q3)*sin(q4)*sin(q5) - a2*m5*tcm51*cos(q5)*sin(q3)*sin(q4) - a2*m6*tcm61*cos(q3)*sin(q4)*sin(q6) - a2*m6*tcm61*cos(q4)*sin(q3)*sin(q6) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + a2*m5*tcm53*sin(q3)*sin(q4)*sin(q5) + a2*m6*tcm63*sin(q3)*sin(q4)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6) - a2*m6*tcm62*cos(q3)*cos(q4)*cos(q5)*sin(q6) - a2*m6*tcm61*cos(q5)*cos(q6)*sin(q3)*sin(q4) + a2*m6*tcm62*cos(q5)*sin(q3)*sin(q4)*sin(q6) + a2*m6*tcm61*cos(q3)*cos(q4)*cos(q5)*cos(q6);
      M(3, 2) = I112 + I122 + I123 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 + a3*d5*m5*sin(q4) + a3*d5*m6*sin(q4) + a3*m4*tcm41*cos(q4) - 2*d5*m6*tcm62*cos(q6) + a3*m4*tcm43*sin(q4) - a3*m5*tcm52*sin(q4) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) - a3*d6*m6*cos(q4)*sin(q5) + a3*m5*tcm51*cos(q4)*cos(q5) - a3*m5*tcm53*cos(q4)*sin(q5) - a3*m6*tcm62*cos(q6)*sin(q4) - a3*m6*tcm63*cos(q4)*sin(q5) - a3*m6*tcm61*sin(q4)*sin(q6) + a3*m6*tcm61*cos(q4)*cos(q5)*cos(q6) - a3*m6*tcm62*cos(q4)*cos(q5)*sin(q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6);
      M(3, 3) = I112 + I122 + I123 + d5^2*m5 + d5^2*m6 + d6^2*m6 + m4*tcm41^2 + m4*tcm43^2 + m5*tcm52^2 + m5*tcm53^2 + m6*tcm61^2 + m6*tcm63^2 - 2*d5*m5*tcm52 + 2*d6*m6*tcm63 - d6^2*m6*cos(q5)^2 + m5*tcm51^2*cos(q5)^2 - m5*tcm53^2*cos(q5)^2 - m6*tcm61^2*cos(q6)^2 + m6*tcm62^2*cos(q5)^2 + m6*tcm62^2*cos(q6)^2 - m6*tcm63^2*cos(q5)^2 + m6*tcm61^2*cos(q5)^2*cos(q6)^2 - m6*tcm62^2*cos(q5)^2*cos(q6)^2 - 2*d5*m6*tcm62*cos(q6) - 2*d5*m6*tcm61*sin(q6) - 2*d6*m6*tcm63*cos(q5)^2 - m5*tcm51*tcm53*sin(2*q5) + m6*tcm61*tcm62*sin(2*q6) - 2*d6*m6*tcm61*cos(q5)*cos(q6)*sin(q5) + 2*d6*m6*tcm62*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q5) + 2*m6*tcm62*tcm63*cos(q5)*sin(q5)*sin(q6) - 2*m6*tcm61*tcm62*cos(q5)^2*cos(q6)*sin(q6);
      M(3, 4) = m5*tcm52*tcm53*cos(q5) - d5*m5*tcm53*cos(q5) - d5*m6*tcm63*cos(q5) - d5*m5*tcm51*sin(q5) - d5*d6*m6*cos(q5) + m5*tcm51*tcm52*sin(q5) - m6*tcm61*tcm62*sin(q5) + m6*tcm61^2*cos(q6)*sin(q5)*sin(q6) - m6*tcm62^2*cos(q6)*sin(q5)*sin(q6) + d6*m6*tcm62*cos(q5)*cos(q6) - d5*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm61*cos(q5)*sin(q6) + m6*tcm62*tcm63*cos(q5)*cos(q6) + d5*m6*tcm62*sin(q5)*sin(q6) + m6*tcm61*tcm63*cos(q5)*sin(q6) + 2*m6*tcm61*tcm62*cos(q6)^2*sin(q5);
      M(3, 5) = I123*cos(q5) + m6*tcm61^2*cos(q5) + m6*tcm62^2*cos(q5) - d5*m6*tcm62*cos(q5)*cos(q6) - d5*m6*tcm61*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm62*sin(q5)*sin(q6) - m6*tcm61*tcm63*cos(q6)*sin(q5) + m6*tcm62*tcm63*sin(q5)*sin(q6);
      M(4, 0) = (m6*tcm61^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - I123*cos(q2 + q3 + q4) - I122*cos(q2 + q3 + q4) - (m6*tcm61^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 - 2*q6))/4 - (m6*tcm61^2*cos(q2 + q3 + q4 + 2*q6))/4 + (m6*tcm62^2*cos(q2 + q3 + q4 - 2*q6))/4 + (m6*tcm62^2*cos(q2 + q3 + q4 + 2*q6))/4 - d6^2*m6*cos(q2 + q3 + q4) - m5*tcm51^2*cos(q2 + q3 + q4) - m5*tcm53^2*cos(q2 + q3 + q4) - (m6*tcm61^2*cos(q2 + q3 + q4))/2 - (m6*tcm62^2*cos(q2 + q3 + q4))/2 - m6*tcm63^2*cos(q2 + q3 + q4) + (m6*tcm61^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (m6*tcm61^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (m6*tcm62^2*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (m6*tcm62^2*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 + q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 + q6))/4 - (a3*d6*m6*sin(q2 + q3 - q5))/2 - (a3*m5*tcm51*cos(q2 + q3 - q5))/2 - (a2*m6*tcm61*cos(q2 + q5 - q6))/4 - (a2*m6*tcm61*cos(q2 - q5 + q6))/4 - (a2*m6*tcm61*cos(q5 - q2 + q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 + q5))/2 - (d5*d6*m6*cos(q2 + q3 + q4 + q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + q5 + 2*q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 - q6))/4 - (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 + q6))/4 - (a3*m5*tcm53*sin(q2 + q3 - q5))/2 - (a3*m6*tcm63*sin(q2 + q3 - q5))/2 - (a2*m6*tcm62*sin(q2 + q5 - q6))/4 + (a2*m6*tcm62*sin(q2 - q5 + q6))/4 + (a2*m6*tcm62*sin(q5 - q2 + q6))/4 - (a3*m6*tcm61*cos(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d5*m5*tcm53*cos(q2 + q3 + q4 + q5))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 - (d5*m6*tcm63*cos(q2 + q3 + q4 + q5))/2 + (a3*m6*tcm62*sin(q2 + q3 + q5 + q6))/4 - (d4*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 + q5))/2 + (m5*tcm52*tcm53*cos(q2 + q3 + q4 + q5))/2 + (a2*d6*m6*sin(q2 + q5))/2 - (a2*m5*tcm51*cos(q2 + q5))/2 + (m5*tcm51*tcm52*sin(q2 + q3 + q4 + q5))/2 + (a2*m5*tcm53*sin(q2 + q5))/2 + (a2*m6*tcm63*sin(q2 + q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 - q6))/4 + (d4*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 - q5 - q6))/4 - (m6*tcm62*tcm63*cos(q2 + q3 + q4 - q5 - q6))/4 - (d4*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (d5*d6*m6*cos(q2 + q3 + q4 - q5))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 - 2*q6))/4 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 - q5 + 2*q6))/4 + (m6*tcm61*tcm63*sin(q2 + q3 + q4 - q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 + q5 - q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 + q6))/4 - (d4*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 + (d5*m5*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 + (d5*m6*tcm63*cos(q2 + q3 + q4 - q5))/2 - (a3*m6*tcm62*sin(q2 + q3 + q5 - q6))/4 + (a3*m6*tcm62*sin(q2 + q3 - q5 + q6))/4 + (d4*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (d5*m5*tcm51*sin(q2 + q3 + q4 - q5))/2 - (m5*tcm52*tcm53*cos(q2 + q3 + q4 - q5))/2 - (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*d6*m6*sin(q2 - q5))/2 - (a2*m5*tcm51*cos(q2 - q5))/2 + (m5*tcm51*tcm52*sin(q2 + q3 + q4 - q5))/2 - (m6*tcm61*tcm62*sin(q2 + q3 + q4 - 2*q6))/2 + (m6*tcm61*tcm62*sin(q2 + q3 + q4 + 2*q6))/2 - (d4*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 - (d5*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (d6*m6*tcm61*sin(q2 + q3 + q4 + q5 + q6))/4 + (m6*tcm62*tcm63*cos(q2 + q3 + q4 + q5 + q6))/4 - (a2*m5*tcm53*sin(q2 - q5))/2 - (a2*m6*tcm63*sin(q2 - q5))/2 + (a3*d6*m6*sin(q2 + q3 + q5))/2 - (a3*m5*tcm51*cos(q2 + q3 + q5))/2 - (a2*m6*tcm61*cos(q2 + q5 + q6))/4 - 2*d6*m6*tcm63*cos(q2 + q3 + q4) + (m6*tcm61*tcm63*sin(q2 + q3 + q4 + q5 + q6))/4 + (a3*m5*tcm53*sin(q2 + q3 + q5))/2 + (a3*m6*tcm63*sin(q2 + q3 + q5))/2 + (a2*m6*tcm62*sin(q2 + q5 + q6))/4 - (a3*m6*tcm61*cos(q2 + q3 - q5 - q6))/4 - (a3*m6*tcm62*sin(q2 + q3 - q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 + (d4*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 + (d5*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d5*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4 + (d6*m6*tcm62*cos(q2 + q3 + q4 + q5 - q6))/4 - (d6*m6*tcm62*cos(q2 + q3 + q4 - q5 + q6))/4;
      M(4, 1) = m5*tcm52*tcm53*cos(q5) - d5*m5*tcm53*cos(q5) - d5*m6*tcm63*cos(q5) - d5*m5*tcm51*sin(q5) - d5*d6*m6*cos(q5) + m5*tcm51*tcm52*sin(q5) - m6*tcm61*tcm62*sin(q5) + m6*tcm61^2*cos(q6)*sin(q5)*sin(q6) - m6*tcm62^2*cos(q6)*sin(q5)*sin(q6) - a3*d6*m6*cos(q5)*sin(q4) + d6*m6*tcm62*cos(q5)*cos(q6) - a3*m5*tcm53*cos(q5)*sin(q4) - a3*m6*tcm63*cos(q5)*sin(q4) - d5*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm61*cos(q5)*sin(q6) + m6*tcm62*tcm63*cos(q5)*cos(q6) - a3*m5*tcm51*sin(q4)*sin(q5) + d5*m6*tcm62*sin(q5)*sin(q6) + m6*tcm61*tcm63*cos(q5)*sin(q6) + 2*m6*tcm61*tcm62*cos(q6)^2*sin(q5) - a2*d6*m6*cos(q3)*cos(q5)*sin(q4) - a2*d6*m6*cos(q4)*cos(q5)*sin(q3) - a2*m5*tcm53*cos(q3)*cos(q5)*sin(q4) - a2*m5*tcm53*cos(q4)*cos(q5)*sin(q3) - a2*m6*tcm63*cos(q3)*cos(q5)*sin(q4) - a2*m6*tcm63*cos(q4)*cos(q5)*sin(q3) - a2*m5*tcm51*cos(q3)*sin(q4)*sin(q5) - a2*m5*tcm51*cos(q4)*sin(q3)*sin(q5) - a3*m6*tcm61*cos(q6)*sin(q4)*sin(q5) + a3*m6*tcm62*sin(q4)*sin(q5)*sin(q6) - a2*m6*tcm61*cos(q3)*cos(q6)*sin(q4)*sin(q5) - a2*m6*tcm61*cos(q4)*cos(q6)*sin(q3)*sin(q5) + a2*m6*tcm62*cos(q3)*sin(q4)*sin(q5)*sin(q6) + a2*m6*tcm62*cos(q4)*sin(q3)*sin(q5)*sin(q6);
      M(4, 2) = m5*tcm52*tcm53*cos(q5) - d5*m5*tcm53*cos(q5) - d5*m6*tcm63*cos(q5) - d5*m5*tcm51*sin(q5) - d5*d6*m6*cos(q5) + m5*tcm51*tcm52*sin(q5) - m6*tcm61*tcm62*sin(q5) + m6*tcm61^2*cos(q6)*sin(q5)*sin(q6) - m6*tcm62^2*cos(q6)*sin(q5)*sin(q6) - a3*d6*m6*cos(q5)*sin(q4) + d6*m6*tcm62*cos(q5)*cos(q6) - a3*m5*tcm53*cos(q5)*sin(q4) - a3*m6*tcm63*cos(q5)*sin(q4) - d5*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm61*cos(q5)*sin(q6) + m6*tcm62*tcm63*cos(q5)*cos(q6) - a3*m5*tcm51*sin(q4)*sin(q5) + d5*m6*tcm62*sin(q5)*sin(q6) + m6*tcm61*tcm63*cos(q5)*sin(q6) + 2*m6*tcm61*tcm62*cos(q6)^2*sin(q5) - a3*m6*tcm61*cos(q6)*sin(q4)*sin(q5) + a3*m6*tcm62*sin(q4)*sin(q5)*sin(q6);
      M(4, 3) = m5*tcm52*tcm53*cos(q5) - d5*m5*tcm53*cos(q5) - d5*m6*tcm63*cos(q5) - d5*m5*tcm51*sin(q5) - d5*d6*m6*cos(q5) + m5*tcm51*tcm52*sin(q5) - m6*tcm61*tcm62*sin(q5) + m6*tcm61^2*cos(q6)*sin(q5)*sin(q6) - m6*tcm62^2*cos(q6)*sin(q5)*sin(q6) + d6*m6*tcm62*cos(q5)*cos(q6) - d5*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm61*cos(q5)*sin(q6) + m6*tcm62*tcm63*cos(q5)*cos(q6) + d5*m6*tcm62*sin(q5)*sin(q6) + m6*tcm61*tcm63*cos(q5)*sin(q6) + 2*m6*tcm61*tcm62*cos(q6)^2*sin(q5);
      M(4, 4) = I122 + I123 + d6^2*m6 + m5*tcm51^2 + m5*tcm53^2 + m6*tcm62^2 + m6*tcm63^2 + 2*d6*m6*tcm63 + m6*tcm61^2*cos(q6)^2 - m6*tcm62^2*cos(q6)^2 - m6*tcm61*tcm62*sin(2*q6);
      M(4, 5) = m6*(d6 + tcm63)*(tcm62*cos(q6) + tcm61*sin(q6));
      M(5, 0) = I123*sin(q2)*sin(q3)*sin(q4)*sin(q5) - I123*cos(q2)*cos(q4)*sin(q3)*sin(q5) - I123*cos(q3)*cos(q4)*sin(q2)*sin(q5) - I123*cos(q2)*cos(q3)*sin(q4)*sin(q5) - m6*tcm61^2*cos(q2)*cos(q3)*sin(q4)*sin(q5) - m6*tcm61^2*cos(q2)*cos(q4)*sin(q3)*sin(q5) - m6*tcm61^2*cos(q3)*cos(q4)*sin(q2)*sin(q5) - m6*tcm62^2*cos(q2)*cos(q3)*sin(q4)*sin(q5) - m6*tcm62^2*cos(q2)*cos(q4)*sin(q3)*sin(q5) - m6*tcm62^2*cos(q3)*cos(q4)*sin(q2)*sin(q5) + a2*m6*tcm62*cos(q2)*cos(q6)*sin(q5) + m6*tcm61^2*sin(q2)*sin(q3)*sin(q4)*sin(q5) + m6*tcm62^2*sin(q2)*sin(q3)*sin(q4)*sin(q5) + a2*m6*tcm61*cos(q2)*sin(q5)*sin(q6) + a3*m6*tcm62*cos(q2)*cos(q3)*cos(q6)*sin(q5) - d4*m6*tcm61*cos(q2)*cos(q3)*cos(q6)*sin(q4) - d4*m6*tcm61*cos(q2)*cos(q4)*cos(q6)*sin(q3) - d4*m6*tcm61*cos(q3)*cos(q4)*cos(q6)*sin(q2) - d6*m6*tcm61*cos(q2)*cos(q3)*cos(q4)*sin(q6) - m6*tcm62*tcm63*cos(q2)*cos(q3)*cos(q4)*cos(q6) + a3*m6*tcm61*cos(q2)*cos(q3)*sin(q5)*sin(q6) + d4*m6*tcm62*cos(q2)*cos(q3)*sin(q4)*sin(q6) + d4*m6*tcm62*cos(q2)*cos(q4)*sin(q3)*sin(q6) + d4*m6*tcm62*cos(q3)*cos(q4)*sin(q2)*sin(q6) + d6*m6*tcm62*cos(q2)*cos(q6)*sin(q3)*sin(q4) + d6*m6*tcm62*cos(q3)*cos(q6)*sin(q2)*sin(q4) + d6*m6*tcm62*cos(q4)*cos(q6)*sin(q2)*sin(q3) - m6*tcm61*tcm63*cos(q2)*cos(q3)*cos(q4)*sin(q6) - a3*m6*tcm62*cos(q6)*sin(q2)*sin(q3)*sin(q5) + d4*m6*tcm61*cos(q6)*sin(q2)*sin(q3)*sin(q4) + d6*m6*tcm61*cos(q2)*sin(q3)*sin(q4)*sin(q6) + d6*m6*tcm61*cos(q3)*sin(q2)*sin(q4)*sin(q6) + d6*m6*tcm61*cos(q4)*sin(q2)*sin(q3)*sin(q6) + m6*tcm62*tcm63*cos(q2)*cos(q6)*sin(q3)*sin(q4) + m6*tcm62*tcm63*cos(q3)*cos(q6)*sin(q2)*sin(q4) + m6*tcm62*tcm63*cos(q4)*cos(q6)*sin(q2)*sin(q3) - a3*m6*tcm61*sin(q2)*sin(q3)*sin(q5)*sin(q6) - d4*m6*tcm62*sin(q2)*sin(q3)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q2)*sin(q3)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q3)*sin(q2)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q4)*sin(q2)*sin(q3)*sin(q6) - d6*m6*tcm62*cos(q2)*cos(q3)*cos(q4)*cos(q6) - d5*m6*tcm62*cos(q6)*sin(q2)*sin(q3)*sin(q4)*sin(q5) - d6*m6*tcm62*cos(q5)*sin(q2)*sin(q3)*sin(q4)*sin(q6) + m6*tcm61*tcm63*cos(q5)*cos(q6)*sin(q2)*sin(q3)*sin(q4) - d5*m6*tcm61*sin(q2)*sin(q3)*sin(q4)*sin(q5)*sin(q6) - m6*tcm62*tcm63*cos(q5)*sin(q2)*sin(q3)*sin(q4)*sin(q6) - d4*m6*tcm62*cos(q2)*cos(q3)*cos(q4)*cos(q5)*cos(q6) - d4*m6*tcm61*cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q2)*cos(q3)*cos(q5)*cos(q6)*sin(q4) - d6*m6*tcm61*cos(q2)*cos(q4)*cos(q5)*cos(q6)*sin(q3) - d6*m6*tcm61*cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(q2) + d4*m6*tcm62*cos(q2)*cos(q5)*cos(q6)*sin(q3)*sin(q4) + d4*m6*tcm62*cos(q3)*cos(q5)*cos(q6)*sin(q2)*sin(q4) + d4*m6*tcm62*cos(q4)*cos(q5)*cos(q6)*sin(q2)*sin(q3) + d5*m6*tcm62*cos(q2)*cos(q3)*cos(q6)*sin(q4)*sin(q5) + d5*m6*tcm62*cos(q2)*cos(q4)*cos(q6)*sin(q3)*sin(q5) + d5*m6*tcm62*cos(q3)*cos(q4)*cos(q6)*sin(q2)*sin(q5) + d6*m6*tcm62*cos(q2)*cos(q3)*cos(q5)*sin(q4)*sin(q6) + d6*m6*tcm62*cos(q2)*cos(q4)*cos(q5)*sin(q3)*sin(q6) + d6*m6*tcm62*cos(q3)*cos(q4)*cos(q5)*sin(q2)*sin(q6) - m6*tcm61*tcm63*cos(q2)*cos(q3)*cos(q5)*cos(q6)*sin(q4) - m6*tcm61*tcm63*cos(q2)*cos(q4)*cos(q5)*cos(q6)*sin(q3) - m6*tcm61*tcm63*cos(q3)*cos(q4)*cos(q5)*cos(q6)*sin(q2) + d4*m6*tcm61*cos(q2)*cos(q5)*sin(q3)*sin(q4)*sin(q6) + d4*m6*tcm61*cos(q3)*cos(q5)*sin(q2)*sin(q4)*sin(q6) + d4*m6*tcm61*cos(q4)*cos(q5)*sin(q2)*sin(q3)*sin(q6) + d5*m6*tcm61*cos(q2)*cos(q3)*sin(q4)*sin(q5)*sin(q6) + d5*m6*tcm61*cos(q2)*cos(q4)*sin(q3)*sin(q5)*sin(q6) + d5*m6*tcm61*cos(q3)*cos(q4)*sin(q2)*sin(q5)*sin(q6) + d6*m6*tcm61*cos(q5)*cos(q6)*sin(q2)*sin(q3)*sin(q4) + m6*tcm62*tcm63*cos(q2)*cos(q3)*cos(q5)*sin(q4)*sin(q6) + m6*tcm62*tcm63*cos(q2)*cos(q4)*cos(q5)*sin(q3)*sin(q6) + m6*tcm62*tcm63*cos(q3)*cos(q4)*cos(q5)*sin(q2)*sin(q6);
      M(5, 1) = I123*cos(q5) + m6*tcm61^2*cos(q5) + m6*tcm62^2*cos(q5) + a3*m6*tcm61*cos(q4)*cos(q6) - d5*m6*tcm62*cos(q5)*cos(q6) - a3*m6*tcm62*cos(q4)*sin(q6) - d5*m6*tcm61*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm62*sin(q5)*sin(q6) - m6*tcm61*tcm63*cos(q6)*sin(q5) + m6*tcm62*tcm63*sin(q5)*sin(q6) + a2*m6*tcm61*cos(q3)*cos(q4)*cos(q6) - a2*m6*tcm62*cos(q3)*cos(q4)*sin(q6) - a3*m6*tcm62*cos(q5)*cos(q6)*sin(q4) - a2*m6*tcm61*cos(q6)*sin(q3)*sin(q4) - a3*m6*tcm61*cos(q5)*sin(q4)*sin(q6) + a2*m6*tcm62*sin(q3)*sin(q4)*sin(q6) - a2*m6*tcm62*cos(q3)*cos(q5)*cos(q6)*sin(q4) - a2*m6*tcm62*cos(q4)*cos(q5)*cos(q6)*sin(q3) - a2*m6*tcm61*cos(q3)*cos(q5)*sin(q4)*sin(q6) - a2*m6*tcm61*cos(q4)*cos(q5)*sin(q3)*sin(q6);
      M(5, 2) = I123*cos(q5) + m6*tcm61^2*cos(q5) + m6*tcm62^2*cos(q5) + a3*m6*tcm61*cos(q4)*cos(q6) - d5*m6*tcm62*cos(q5)*cos(q6) - a3*m6*tcm62*cos(q4)*sin(q6) - d5*m6*tcm61*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm62*sin(q5)*sin(q6) - m6*tcm61*tcm63*cos(q6)*sin(q5) + m6*tcm62*tcm63*sin(q5)*sin(q6) - a3*m6*tcm62*cos(q5)*cos(q6)*sin(q4) - a3*m6*tcm61*cos(q5)*sin(q4)*sin(q6);
      M(5, 3) = I123*cos(q5) + m6*tcm61^2*cos(q5) + m6*tcm62^2*cos(q5) - d5*m6*tcm62*cos(q5)*cos(q6) - d5*m6*tcm61*cos(q5)*sin(q6) - d6*m6*tcm61*cos(q6)*sin(q5) + d6*m6*tcm62*sin(q5)*sin(q6) - m6*tcm61*tcm63*cos(q6)*sin(q5) + m6*tcm62*tcm63*sin(q5)*sin(q6);
      M(5, 4) = m6*(d6 + tcm63)*(tcm62*cos(q6) + tcm61*sin(q6));
      M(5, 5) = m6*tcm61^2 + m6*tcm62^2 + I123;
      M_ = M;
    }

    void UR10Model::computeCoriolisMatrix()
    {

    }

    void UR10Model::computeGeneralizedGravity()
    {
      Vector6d G = Vector6d::Zero();
      G(0) = 0;
      G(1) = g*(a2*m2*cos(q2) + a2*m3*cos(q2) + a2*m4*cos(q2) + a2*m5*cos(q2) + a2*m6*cos(q2) + m2*tcm21*cos(q2) - m2*tcm22*sin(q2) + d5*m5*sin(q2 + q3 + q4) + d5*m6*sin(q2 + q3 + q4) + m4*tcm41*cos(q2 + q3 + q4) + m4*tcm43*sin(q2 + q3 + q4) - m5*tcm52*sin(q2 + q3 + q4) + a3*m3*cos(q2 + q3) + a3*m4*cos(q2 + q3) + a3*m5*cos(q2 + q3) + a3*m6*cos(q2 + q3) + m3*tcm31*cos(q2 + q3) - m3*tcm32*sin(q2 + q3) - d6*m6*cos(q2 + q3 + q4)*sin(q5) + m5*tcm51*cos(q2 + q3 + q4)*cos(q5) - m5*tcm53*cos(q2 + q3 + q4)*sin(q5) - m6*tcm63*cos(q2 + q3 + q4)*sin(q5) - m6*tcm62*cos(q2 + q3)*cos(q6)*sin(q4) - m6*tcm62*sin(q2 + q3)*cos(q4)*cos(q6) - m6*tcm61*cos(q2 + q3)*sin(q4)*sin(q6) - m6*tcm61*sin(q2 + q3)*cos(q4)*sin(q6) + m6*tcm61*cos(q2 + q3)*cos(q4)*cos(q5)*cos(q6) - m6*tcm62*cos(q2 + q3)*cos(q4)*cos(q5)*sin(q6) - m6*tcm61*sin(q2 + q3)*cos(q5)*cos(q6)*sin(q4) + m6*tcm62*sin(q2 + q3)*cos(q5)*sin(q4)*sin(q6));
      G(2) = g*(d5*m5*sin(q2 + q3 + q4) + d5*m6*sin(q2 + q3 + q4) + m4*tcm41*cos(q2 + q3 + q4) + m4*tcm43*sin(q2 + q3 + q4) - m5*tcm52*sin(q2 + q3 + q4) + a3*m3*cos(q2 + q3) + a3*m4*cos(q2 + q3) + a3*m5*cos(q2 + q3) + a3*m6*cos(q2 + q3) + m3*tcm31*cos(q2 + q3) - m3*tcm32*sin(q2 + q3) - d6*m6*cos(q2 + q3 + q4)*sin(q5) + m5*tcm51*cos(q2 + q3 + q4)*cos(q5) - m5*tcm53*cos(q2 + q3 + q4)*sin(q5) - m6*tcm63*cos(q2 + q3 + q4)*sin(q5) - m6*tcm62*cos(q2 + q3)*cos(q6)*sin(q4) - m6*tcm62*sin(q2 + q3)*cos(q4)*cos(q6) - m6*tcm61*cos(q2 + q3)*sin(q4)*sin(q6) - m6*tcm61*sin(q2 + q3)*cos(q4)*sin(q6) + m6*tcm61*cos(q2 + q3)*cos(q4)*cos(q5)*cos(q6) - m6*tcm62*cos(q2 + q3)*cos(q4)*cos(q5)*sin(q6) - m6*tcm61*sin(q2 + q3)*cos(q5)*cos(q6)*sin(q4) + m6*tcm62*sin(q2 + q3)*cos(q5)*sin(q4)*sin(q6));
      G(3) = g*m5*(d5*sin(q2 + q3 + q4) - tcm52*sin(q2 + q3 + q4) + tcm51*cos(q2 + q3 + q4)*cos(q5) - tcm53*cos(q2 + q3 + q4)*sin(q5)) - g*m6*(d6*cos(q2 + q3 + q4)*sin(q5) - d5*sin(q2 + q3 + q4) + tcm63*cos(q2 + q3 + q4)*sin(q5) + tcm62*cos(q2 + q3)*cos(q6)*sin(q4) + tcm62*sin(q2 + q3)*cos(q4)*cos(q6) + tcm61*cos(q2 + q3)*sin(q4)*sin(q6) + tcm61*sin(q2 + q3)*cos(q4)*sin(q6) + tcm62*cos(q2 + q3)*cos(q4)*cos(q5)*sin(q6) + tcm61*sin(q2 + q3)*cos(q5)*cos(q6)*sin(q4) - tcm62*sin(q2 + q3)*cos(q5)*sin(q4)*sin(q6) - tcm61*cos(q2 + q3)*cos(q4)*cos(q5)*cos(q6)) + g*m4*(tcm41*cos(q2 + q3 + q4) + tcm43*sin(q2 + q3 + q4));
      G(4) = -g*m6*(d6*sin(q2 + q3 + q4)*cos(q5) + tcm63*sin(q2 + q3 + q4)*cos(q5) + tcm61*cos(q2 + q3)*cos(q6)*sin(q4)*sin(q5) + tcm61*sin(q2 + q3)*cos(q4)*cos(q6)*sin(q5) - tcm62*cos(q2 + q3)*sin(q4)*sin(q5)*sin(q6) - tcm62*sin(q2 + q3)*cos(q4)*sin(q5)*sin(q6)) - g*m5*sin(q2 + q3 + q4)*(tcm53*cos(q5) + tcm51*sin(q5));
      G(5) = -g*m6*(tcm62*cos(q2 + q3)*cos(q4)*sin(q6) - tcm61*cos(q2 + q3)*cos(q4)*cos(q6) + tcm61*sin(q2 + q3)*cos(q6)*sin(q4) - tcm62*sin(q2 + q3)*sin(q4)*sin(q6) + tcm62*cos(q2 + q3)*cos(q5)*cos(q6)*sin(q4) + tcm62*sin(q2 + q3)*cos(q4)*cos(q5)*cos(q6) + tcm61*cos(q2 + q3)*cos(q5)*sin(q4)*sin(q6) + tcm61*sin(q2 + q3)*cos(q4)*cos(q5)*sin(q6));
      G_ = G;
    }

    void UR10Model::computeAllTerms()
    {

    }

    void UR10Model::computeFKJoint0()
    {
      Matrix4d H = Matrix4d::Identity();
      H(0, 0) = cos(state_.q(0));
      H(0, 1) = 0;
      H(0, 2) = sin(state_.q(0));
      H(0, 3) = 0;
      H(1, 0) = sin(state_.q(0));
      H(1, 1) = 0;
      H(1, 2) = -cos(state_.q(0));
      H(1, 3) = 0;
      H(2, 0) = 0;
      H(2, 1) = 1;
      H(2, 2) = 0;
      H(2, 3) = ps_.l(0);
      H_0_[0] = H;
    }

    void UR10Model::computeFKJoint1()
    {
      Matrix4d H = Matrix4d::Identity();
      H(0, 0) = cos(state_.q(0))*cos(state_.q(1));
      H(0, 1) = -cos(state_.q(0))*sin(state_.q(1));
      H(0, 2) = sin(state_.q(0));
      H(0, 3) = ps_.l(1)*cos(state_.q(0))*cos(state_.q(1));
      H(1, 0) = cos(state_.q(1))*sin(state_.q(0));
      H(1, 1) = -sin(state_.q(0))*sin(state_.q(1));
      H(1, 2) = -cos(state_.q(0));
      H(1, 3) = ps_.l(1)*cos(state_.q(1))*sin(state_.q(0));
      H(2, 0) = sin(state_.q(1));
      H(2, 1) = cos(state_.q(1));
      H(2, 2) = 0;
      H(2, 3) = ps_.l(0) + ps_.l(1)*sin(state_.q(1));
      H_0_[1] = H;
    }

    void UR10Model::computeFKJoint2()
    {
      Matrix4d H = Matrix4d::Identity();
      H(0, 0) = cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(0, 1) = - cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) - cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1));
      H(0, 2) = sin(state_.q(0));
      H(0, 3) = ps_.l(1)*cos(state_.q(0))*cos(state_.q(1)) + ps_.l(2)*cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - ps_.l(2)*cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(1, 0) = cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)) - sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(1, 1) = - cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) - cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1));
      H(1, 2) = -cos(state_.q(0));
      H(1, 3) = ps_.l(1)*cos(state_.q(1))*sin(state_.q(0)) + ps_.l(2)*cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)) - ps_.l(2)*sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(2, 0) = cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1));
      H(2, 1) = cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2));
      H(2, 2) = 0;
      H(2, 3) = ps_.l(0) + ps_.l(1)*sin(state_.q(1)) + ps_.l(2)*cos(state_.q(1))*sin(state_.q(2)) + ps_.l(2)*cos(state_.q(2))*sin(state_.q(1));
      H_0_[2] = H;
    }

    void UR10Model::computeFKJoint3()
    {
      Matrix4d H = Matrix4d::Identity();
      H(0, 0) = cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1)));
      H(0, 1) = sin(state_.q(0));
      H(0, 2) = cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)));
      H(0, 3) = ps_.l(3)*sin(state_.q(0)) + ps_.l(1)*cos(state_.q(0))*cos(state_.q(1)) + ps_.l(2)*cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - ps_.l(2)*cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(1, 0) = - cos(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) - sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1)));
      H(1, 1) = -cos(state_.q(0));
      H(1, 2) = cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))) - sin(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)));
      H(1, 3) = ps_.l(1)*cos(state_.q(1))*sin(state_.q(0)) - ps_.l(3)*cos(state_.q(0)) + ps_.l(2)*cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)) - ps_.l(2)*sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(2, 0) = cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2)));
      H(2, 1) = 0;
      H(2, 2) = sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) - cos(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2)));
      H(2, 3) = ps_.l(0) + ps_.l(1)*sin(state_.q(1)) + ps_.l(2)*cos(state_.q(1))*sin(state_.q(2)) + ps_.l(2)*cos(state_.q(2))*sin(state_.q(1));
      H_0_[3] = H;
    }

    void UR10Model::computeFKJoint4()
    {
      Matrix4d H = Matrix4d::Identity();
      H(0, 0) = sin(state_.q(0))*sin(state_.q(4)) + cos(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))));
      H(0, 1) = - cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)));
      H(0, 2) = cos(state_.q(4))*sin(state_.q(0)) - sin(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))));
      H(0, 3) = ps_.l(4)*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)))) + ps_.l(3)*sin(state_.q(0)) + ps_.l(1)*cos(state_.q(0))*cos(state_.q(1)) + ps_.l(2)*cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - ps_.l(2)*cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(1, 0) = - cos(state_.q(0))*sin(state_.q(4)) - cos(state_.q(4))*(cos(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) + sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))));
      H(1, 1) = sin(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) - cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1)));
      H(1, 2) = sin(state_.q(4))*(cos(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) + sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1)))) - cos(state_.q(0))*cos(state_.q(4));
      H(1, 3) = ps_.l(4)*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))) - sin(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)))) - ps_.l(3)*cos(state_.q(0)) + ps_.l(1)*cos(state_.q(1))*sin(state_.q(0)) + ps_.l(2)*cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)) - ps_.l(2)*sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(2, 0) = cos(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))));
      H(2, 1) = cos(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1)));
      H(2, 2) = -sin(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))));
      H(2, 3) = ps_.l(0) + ps_.l(1)*sin(state_.q(1)) - ps_.l(4)*(cos(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1)))) + ps_.l(2)*cos(state_.q(1))*sin(state_.q(2)) + ps_.l(2)*cos(state_.q(2))*sin(state_.q(1));
      H_0_[4] = H;
    }

    void UR10Model::computeFKJoint5()
    {
      Matrix4d H = Matrix4d::Identity();
      H(0, 0) = cos(state_.q(5))*(sin(state_.q(0))*sin(state_.q(4)) + cos(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))))) - sin(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))));
      H(0, 1) = - sin(state_.q(5))*(sin(state_.q(0))*sin(state_.q(4)) + cos(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))))) - cos(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))));
      H(0, 2) = cos(state_.q(4))*sin(state_.q(0)) - sin(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))));
      H(0, 3) = ps_.l(4)*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)))) + ps_.l(3)*sin(state_.q(0)) + ps_.l(5)*(cos(state_.q(4))*sin(state_.q(0)) - sin(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(0))*cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(0))*cos(state_.q(2))*sin(state_.q(1))))) + ps_.l(1)*cos(state_.q(0))*cos(state_.q(1)) + ps_.l(2)*cos(state_.q(0))*cos(state_.q(1))*cos(state_.q(2)) - ps_.l(2)*cos(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(1, 0) = - cos(state_.q(5))*(cos(state_.q(0))*sin(state_.q(4)) + cos(state_.q(4))*(cos(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) + sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))))) - sin(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))) - sin(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))));
      H(1, 1) = sin(state_.q(5))*(cos(state_.q(0))*sin(state_.q(4)) + cos(state_.q(4))*(cos(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) + sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))))) - cos(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))) - sin(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))));
      H(1, 2) = sin(state_.q(4))*(cos(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) + sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1)))) - cos(state_.q(0))*cos(state_.q(4));
      H(1, 3) = ps_.l(4)*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))) - sin(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)))) - ps_.l(3)*cos(state_.q(0)) - ps_.l(5)*(cos(state_.q(0))*cos(state_.q(4)) - sin(state_.q(4))*(cos(state_.q(3))*(sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2)) - cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0))) + sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(0))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(0))*sin(state_.q(1))))) + ps_.l(1)*cos(state_.q(1))*sin(state_.q(0)) + ps_.l(2)*cos(state_.q(1))*cos(state_.q(2))*sin(state_.q(0)) - ps_.l(2)*sin(state_.q(0))*sin(state_.q(1))*sin(state_.q(2));
      H(2, 0) = sin(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1)))) + cos(state_.q(4))*cos(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))));
      H(2, 1) = cos(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1)))) - cos(state_.q(4))*sin(state_.q(5))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))));
      H(2, 2) = -sin(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))));
      H(2, 3) = ps_.l(0) + ps_.l(1)*sin(state_.q(1)) - ps_.l(4)*(cos(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))) - sin(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1)))) + ps_.l(2)*cos(state_.q(1))*sin(state_.q(2)) + ps_.l(2)*cos(state_.q(2))*sin(state_.q(1)) - ps_.l(5)*sin(state_.q(4))*(cos(state_.q(3))*(cos(state_.q(1))*sin(state_.q(2)) + cos(state_.q(2))*sin(state_.q(1))) + sin(state_.q(3))*(cos(state_.q(1))*cos(state_.q(2)) - sin(state_.q(1))*sin(state_.q(2))));
      H_0_[5] = H;
    }
  }
}